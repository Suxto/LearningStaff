/*1.*/
SELECT SNo,SName,DORMNo 
FROM STUDENT
WHERE DNo = '1'
ORDER BY DORMNo ASC;

/*2.*/
SELECT * 
FROM STUDENT 
WHERE DNo = '1'
ORDER BY sex ASC,SAge DESC;

/*3.*/
SELECT SName, 2003-SAge BIRTHDAY
FROM STUDENT s 
WHERE DNo = '2';

/*4.*/
SELECT DISTINCT CNo 
FROM GRADE;

/*5.*/
SELECT SName,DORMNo
FROM STUDENT 
WHERE SAge BETWEEN 21 AND 23;

/*6.*/
SELECT SName
FROM STUDENT
WHERE DNo IN ('2','3','4');

/*7.*/
SELECT * 
FROM STUDENT
WHERE SName like '张%';

/*8.*/
SELECT * 
FROM STUDENT
WHERE SName like '_明%';

/*9.*/
SELECT CName ,teacher
FROM COURSE 
WHERE CPno IS NULL ;

/*10.*/
SELECT *
FROM STUDENT 
WHERE sex = '男' AND DNo = '1';

/*11.*/
SELECT COUNT(*)
FROM STUDENT
WHERE DNo = '1';

/*12.*/
SELECT 
 MAX(score),MIN(score),AVG(score)
FROM GRADE

/*13.*/
SELECT SNo,SName
FROM STUDENT s
WHERE 4<(
	SELECT COUNT(*)
	FROM GRADE g  
	WHERE g.SNo = s.SNo 
);

/*14.*/
SELECT head ,DORMNo
FROM DEPARTMENT,DORM;

/*15.*/
SELECT s.SName ,d.DORMNo ,d.TELE 
FROM STUDENT s JOIN DORM d 
ON s.DORMNo = d.DORMNo

/*16.*/
SELECT c.CNo ,c.CName ,c1.CName PRE
FROM COURSE c LEFT JOIN COURSE c1
ON c1.CNo = c.CPno ;


/*17.*/
SELECT s.SName,c.CNo ,c.CName  
FROM STUDENT s JOIN GRADE g 
ON s.SNo = g.SNo JOIN COURSE c 
ON g.CNo = c.CNo ;

/*18.*/
SELECT 
s.SNo ,s.SName,c.CName,c.teacher  
FROM STUDENT s JOIN GRADE g 
ON s.SNo = g.SNo JOIN COURSE c 
ON g.CNo = c.CNo ;

/*19.*/
SELECT s.SName ,d.TELE 
FROM STUDENT s JOIN DORM d 
ON s.DORMNo = d.DORMNo 
WHERE s.DNo =(
	SELECT d2.DNo 
	FROM DEPARTMENT d2
	WHERE d2.head = '秦峰'
);

/*20.*/
SELECT s.SName ,s.SAge 
FROM STUDENT s 
WHERE s.SAge >(
	SELECT MAX(s2.SAge)
	FROM STUDENT s2 
	WHERE s2.DNo =(
		SELECT DNo 
		FROM DEPARTMENT d 
		WHERE d.DName = '计算机系'
	)
); 

/*21.*/
SELECT SName
FROM STUDENT s 
WHERE EXISTS (
	SELECT * 
	FROM GRADE g 
	WHERE g.score >60 
		AND g.SNo = s.SNo 
		AND g.CNo =(
			SELECT c.CNo 
			FROM COURSE c
			WHERE c.CName = '数据库原理'
		)
);

/*22.*/
SELECT g.SNo
FROM GRADE g 
WHERE g.CNo = '01'
INTERSECT 
SELECT g2.SNo 
FROM GRADE g2 
WHERE g2.CNo = '02';

/*23*/
SELECT DISTINCT g.SNo 
FROM GRADE g 
WHERE (
	SELECT COUNT(*)
	FROM GRADE g2 
	WHERE SNo = '990102'
)IN (
	SELECT COUNT(*)
	FROM GRADE g3 
	WHERE g3.SNo = g.SNo 
		AND g3.CNo IN (
		SELECT g4.CNo 
		FROM GRADE g4 
		WHERE g4.SNo = '990102'
	)
);

/*24.*/
SELECT s.SName 
FROM STUDENT s 
WHERE s.DNo = '1'
EXCEPT 
SELECT s2.SName 
FROM STUDENT s2 
WHERE s2.SAge >20;

/*25.*/
SELECT s.SName 
FROM STUDENT s 
WHERE EXISTS (
	SELECT *
	FROM GRADE g 
	WHERE g.SNo = s.SNo AND 
		g.CNo IN (
			SELECT c.CNo 
			FROM COURSE c
			WHERE c.CName = '数据库原理'
		)
)
INTERSECT
SELECT s.SName 
FROM STUDENT s 
WHERE EXISTS (
	SELECT *
	FROM GRADE g 
	WHERE g.SNo = s.SNo AND 
		g.CNo IN (
			SELECT c.CNo 
			FROM COURSE c
			WHERE c.CName = '高等数学'
		)
)

/*26.*/
CREATE VIEW VIEW_1
AS
SELECT *,2003-SAge BIRTHDAY
FROM STUDENT;

/*27.*/
SELECT v.SNo ,v.SName ,v.DNo  
FROM VIEW_1 v 
WHERE v.SName like '%原%';

/*28.*/
UPDATE VIEW_1 
SET SAge = 23, DORMNo = '2202'
WHERE SName = '李军'

