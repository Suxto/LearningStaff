How to make it: Tutorial
Tags: Greedy, Math
Time Created: August 22, 2022 2:53 PM

[https://codeforces.com/contest/1715/problem/C](https://codeforces.com/contest/1715/problem/C)

**思路**

    这个题的思维点主要在对字串的计算，对于字串，我们可以先假定所有的字符都是一样的，这样的话所有的字串的值都是1。于是答案的初始值可以设为 $\frac{(1+n)n}{2}$。当两个相邻的数字不一样的时候，对字串增加的值是 $pos*(n-pos)$。$pos$ 是前一个数字的位置。

    对每个询问更新一次就可以了。

- Code
    
    ```cpp
    #include <bits/stdc++.h>
    
    //#define debug
    #define MAXN 100010
    #define MOD 1000000007
    #define int long long
    #define double long double
    //#define pos first
    //#define val second
    #define dbg(x) cout << #x << " = " << x << endl
    #define endl '\n'
    using namespace std;
    typedef pair<int, int> pii;
    
    ostream &operator<<(ostream &o, const pii &p) {
        o << '<' << p.first << ',' << p.second << '>';
        return o;
    }
    
    template<typename T>
    ostream &operator<<(ostream &o, vector<T> &x) {
        o << "[";
        for (auto i = x.begin(); i < x.end(); ++i) {
            if (i != x.begin())
                o << ", ";
            o << *i /*<< ' '*/;
        }
        o << "]" << endl;
        return o;
    }
    
    inline void solve() {
        int n, q;
        cin >> n >> q;
        int ans = (n * (n + 1ll)) >> 1;
        vector<int> v(n);
        cin >> v[0];
        function<void(int, int)> update = [&](int pos, int sign) {
            if (v[pos] != v[pos - 1]) {
                ans += sign * (n - pos) * pos;
            }
        };
        for (int i = 1; i < n; i++) {
            cin >> v[i];
            update(i, 1);
        }
        while (q--) {
            int pos, x;
            cin >> pos >> x;
            --pos;
            update(pos, -1);
            update(pos + 1, -1);
            v[pos] = x;
            update(pos, 1);
            update(pos + 1, 1);
            cout << ans << endl;
        }
    }
    
    signed main() {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);
        cin.exceptions(std::istream::failbit);
        cout.tie(nullptr);
    
        int T = 1;
        // cin >> T;
        while (T--) {
            solve();
        }
        return 0;
    }
    ```