Tags: Math, Simulate, Sort
Time Created: August 14, 2022 5:02 PM

[https://ac.nowcoder.com/acm/contest/33193/F](https://ac.nowcoder.com/acm/contest/33193/F)

**思路：**

     显然，如果在A串中找到一个和B串相同的数字，后面的结果都是一样的。于是将A串二分查找然后排序，在这里主要需要调试的是 `lower_bound` 的代码。

- Code
    
    ```cpp
    #include <bits/stdc++.h>
    
    #define MAXN 2000020
    #define int long long
    #define endl '\n'
    #define IO cin.tie(nullptr)->sync_with_stdio(0)
    #define double long double
    
    using namespace std;
    typedef uint64_t ll;
    typedef __int128_t lol;
    typedef pair<int, int> pii;
    
    ostream &operator<<(ostream &o, pii p) {
        o << '<' << p.first << ',' << p.second << '>';
        return o;
    }
    
    template <typename T> ostream &operator<<(ostream &o, vector<T> &x) {
        o << "[";
        for (auto i = x.begin(); i < x.end(); ++i) {
            if (i != x.begin())
                o << ", ";
            o << *i /*<< ' '*/;
        }
        o << "]" << endl;
        return o;
    }
    
    int n, m, p, x, a, b, c;
    
    inline int calc(int x) {
        return ((((x * x) % p * a) % p + (x * b) % p) % p + c) % p;
    }
    
    void solve() {
        int ans = 0;
        cin >> n >> m >> p >> x >> a >> b >> c;
        vector<pii> v;
        v.clear();
        for (int i = 0; i < n; i++) {
            x = calc(x);
            v.emplace_back(x, i);
        }
        sort(v.begin(), v.end(), [&](pii a, pii b) {
            if (a.first != b.first)
                return a.first < b.first;
            return a.second < b.second;
        });
        // cout << v;
        for (int i = 0; i < m; i++) {
            x = calc(x);
            int l = 0, r = n - 1;
            while (l <= r) {
                int mid = (l + r) >> 1;
                if (v[mid].first >= x)
                    r = mid - 1;
                else
                    l = mid + 1;
            }
            if (l < 0 || l >= n)
                continue;
            if (v[l].first == x) {
                // cout << l << ' ';
                ans = max(ans, min(n - v[l].second, m - i));
            }
        }
        cout << ans << endl;
    }
    
    signed main() {
        ios::sync_with_stdio(0);
        cin.tie(0);
        int T = 1;
        cin >> T;
        while (T--)
            solve();
        return 0;
    }
    ```