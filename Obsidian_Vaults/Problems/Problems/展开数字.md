How to make it: Tutorial
Tags: Greedy
Time Created: June 26, 2022 4:44 PM

[Problem - C - Codeforces](https://codeforces.com/contest/1696/problem/C)

### 思路：

    其实昨天晚上已经想的很远了，就差最后一步。

昨天想出来的点：

- 两个操作是可逆的
- 可以先将原串完全展开
- 内存不足可以使用 `pair` 来进行简单优化

缺乏的点：

- 可以对目标串也展开
- 将两个完全展开的串进行比较

就是这关键的一步，直接断送了我变绿的机会:（

### 代码：

```cpp
#include <bits/stdc++.h>

using namespace std;
#define  endl '\n'
#define int long long
#define ll int64_t
#define MAXN 1000
typedef pair<int, int> pii;

ostream &operator<<(ostream &o, pii p) {
    o << '<' << p.first << ',' << p.second << '>';
    return o;
}

template<typename T>
ostream &operator<<(ostream &o, vector<T> &x) {
    o << "[ ";
    for (auto i = x.begin(); i < x.end(); ++i) {
//        if (i != x.begin()) o << ", ";
        o << *i << ' ';
    }
    o << "]" << endl;
    return o;
}

int n, m, k;

pii ex(int t) {
    int time = 1ul;
    while (t % m == 0) {
        t = t / m;
        time *= m;
    }
    return {t, time};
}

void expend(vector<int> &o, vector<pii> &e) {
    int len = o.size(), l;
    pii p = ex(o[0]);
    l = p.first;
    e.emplace_back(p);
    for (int i = 1; i < len; i++) {
        p = ex(o[i]);
        if (l == p.first)
            (e.end() - 1)->second += p.second;
        else {
            e.emplace_back(p);
            l = p.first;
        }
    }
}

void solve() {
    cin >> n >> m;
    vector<int> a(n);
    vector<pii> ae;
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }
    expend(a, ae);
//    cout << ae;
    cin >> k;
    vector<int> b(k);
    vector<pii> be;
    for (int i = 0; i < k; i++) {
        cin >> b[i];
    }
    expend(b, be);
//    cout << ae << be;
    if (be.size() != ae.size()) cout << "No\n";
    else {
        for (int i = 0; i < ae.size(); i++) {
            if (ae[i] != be[i]) {
                cout << "No\n";
                return;
            }
        }
        cout << "Yes\n";
    }
}

signed main() {
    cin.tie(nullptr)->sync_with_stdio(false);
    int t = 1;
//	scanf("%lld", &t);
    cin >> t;
    while (t--) solve();
}
```