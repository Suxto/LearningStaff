# 数据库基本操作

[removePdfPages_35762156_3834235653_1.pdf](removePdfPages_35762156_3834235653_1.pdf)

### 登录的步骤

1. 打开MySQL的服务 `sudo net start mysql80` 用命令行启动服务
2. 用终端登录： `mysql -u root -proot -h [localhost](http://localhost) -P13306` 这样可以指定登录服务器的IP和端口以及密码，当然这样的操作是不安全的，直接输入明文密码属实离谱（-p后面不能加空格，不然会识别为第一个字符是空格。同时注意：-p小写的是密码，大写-P是端口）
    
    正确的方式： `mysql -u root -p` ，随后根据提示输入密码
    
3. 用 `select version` 查看当前版本
4. 用 `quit` 退出

### 基本操作

1. `show databases;`
    
    ```bash
    mysql> show databases;//以下的都是MySQL自带的数据库
    +--------------------+
    | Database           |
    +--------------------+
    | information_schema | //储存信息，比如库和表的信息以及权限等
    | mysql              | //MySQL运行的时候需要的信息，字符集等内容
    | performance_schema | //监控性能指标
    | sys                | //监控性能
    +--------------------+
    4 rows in set (0.00 sec)
    ```
    
2. 创建和操作数据库
    
    ```sql
    mysql> create database demo; //create
    Query OK, 1 row affected (0.01 sec)
    
    mysql> use demo; //change the database in use
    Database changed
    
    mysql> show tables; //show all tables in current database
    Empty set (0.01 sec)
    
    mysql> show tables from demo; //this command can select the specifict database
    Empty set (0.00 sec)
    
    mysql> create table stu(id int,name varchar(20));
    //creat a table and define the format how data storaged
    Query OK, 0 rows affected (0.02 sec)
    
    mysql> select * from stu; //show everything in the table
    Empty set (0.01 sec)
    
    mysql> insert into stu values(1,'tom'); //insert a data
    Query OK, 1 row affected (0.00 sec)
    
    mysql> insert into stu values(2,'Jerry');
    Query OK, 1 row affected (0.00 sec)
    
    mysql> show creat table stu; //show the creation info of the table
    ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'creat table stu' at line 1
    mysql> show create table stu;
    +-------+----------------------------------------------------------------------------------------------------------------------------------------------------+
    | Table | Create Table
                                         |
    +-------+----------------------------------------------------------------------------------------------------------------------------------------------------+
    | stu   | CREATE TABLE `stu` (
      `id` int DEFAULT NULL,
      `name` varchar(20) DEFAULT NULL
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci |
    +-------+----------------------------------------------------------------------------------------------------------------------------------------------------+
    1 row in set (0.00 sec)
    
    mysql> show create database demo;
    +----------+--------------------------------------------------------------------------------------------------------------------------------+
    | Database | Create Database
                        |
    +----------+--------------------------------------------------------------------------------------------------------------------------------+
    | demo     | CREATE DATABASE `demo` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */ /*!80016 DEFAULT ENCRYPTION='N' */ |
    +----------+--------------------------------------------------------------------------------------------------------------------------------+
    1 row in set (0.00 sec)
    
    mysql> select * from stu;
    +------+-------+
    | id   | name  |
    +------+-------+
    |    1 | tom   |
    |    2 | Jerry |
    +------+-------+
    2 rows in set (0.00 sec)
    
    mysql> drop table stu; //delete the database and RUN！
    Query OK, 0 rows affected (0.01 sec)
    
    mysql> drop database demo;
    Query OK, 0 rows affected (0.00 sec)
    ```
    

### 调整字符集

在MySQL的5.7版本中，字符集的默认是拉丁文字，但是我们要储存一些中文的字段，就会 `insert` 失败，于是我们应该将字符集改为 `UTF8` 这点在PDF中有详细解释。  

注意：在改变默认字符集之前创建的数据库在改变之后其默认的字符集后不会改变，依然无法加入中文的内容。调整之后创建的表是utf8的。

当然，也可以直接修改需要修改的数据库和表:

```sql
mysql> create database demo1;
Query OK, 1 row affected (0.00 sec)

mysql> show create database demo1;
+----------+---------------------------------------------------------------------------------------------------------------------------------+
| Database | Create Database
                     |
+----------+---------------------------------------------------------------------------------------------------------------------------------+
| demo1    | CREATE DATABASE `demo1` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */ /*!80016 DEFAULT ENCRYPTION='N' */ |
+----------+---------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> alter database demo1 charset latin1;
Query OK, 1 row affected (0.00 sec)

mysql> use demo1;
Database changed

mysql> create table t(id int,name varchar(10));
Query OK, 0 rows affected (0.02 sec)

mysql> show create database t;
ERROR 1049 (42000): Unknown database 't'

mysql> show create table t;
+-------+----------------------------------------------------------------------------------------------------------------------+
| Table | Create Table
       |
+-------+----------------------------------------------------------------------------------------------------------------------+
| t     | CREATE TABLE `t` (
  `id` int DEFAULT NULL,
  `name` varchar(10) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1 |
+-------+----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> alter table t charset utf8;
Query OK, 0 rows affected, 1 warning (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 1

mysql> show create table t;
+-------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table
                             |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------+
| t     | CREATE TABLE `t` (
  `id` int DEFAULT NULL,
  `name` varchar(10) CHARACTER SET latin1 DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 |
+-------+--------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

### 第三方工具链接数据库可能出现的问题

![Untitled](Programming/Programming%20d6786caa2ba94b7983a41b4ab876f28f/MySQL/数据库基本操作%20de8c51cd3401490f86cc4fab5b08e03f/Untitled.png)

由于8.0采用的新的加密方式，如果连接工具比较古老就无法连接，于是我们可以将加密方式改回5.7的版本。

```sql
#使用mysql数据库
USE mysql;
#修改'root'@'localhost'用户的密码规则和密码,注意更换成当前使用的密码
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'Password';
#刷新权限
FLUSH PRIVILEGES;
```

### SQL的分类

1. DDL (Data Definition Languages、**数据定义语言**)，这些语句定义了不同的数据库、表、视图、索引等数据库对象，还可以用来创建、删除、修改数据库和数据表的结构。
主要的语句关键字包括 `CREATE`、 `DROP`、 `ALTER`  、 `RENAME` 、 `TRUNCATE` 等。
2. DML (Data Manipulation Language、**数据操作语言**），用于**添加、删除、更新和查询**数据库记
录，并检查数据完整性。
主要的语句关键字包括 `INSERT`、 `DELETE` 、 `UPDATE`、 `SELECT` 等。
SELECT是SQL语言的基础，最为重要。
3. DCL (Data Control Language、**数据控制语言**），用于定义数据库、表、字段、用户的访问权限和安全级别。
    
    主要的语句关键字包括 `GRAN`、 `REVOKE` 、 `COMMIT` 、 `ROLLBACK` 、 `SAVEPOINT` 等。
    

### 书写规范

推荐采用统一的书写规范：

- 数据库名、表名、表别名、字段名、字段别名等都小写
- SQL 关键字、函数名、绑定变量等都大写

### 导入数据库

```sql
source C:\Users\LY\Desktop\233.sql;
```

当然，图形化工具也可以更加方便的做到。

### 显示表结构

describe可以展示表的所有字段信息，和约束

```sql
mysql> use demo
Database changed
mysql> show tables;
+----------------+
| Tables_in_demo |
+----------------+
| stu            |
+----------------+
1 row in set (0.01 sec)

mysql> desc stu;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| id    | int          | YES  |     | NULL    |       |
| name  | varchar(255) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
2 rows in set (0.00 sec)
```