# 运算符

## 算术运算符

### 加减运算符

算术运算符主要用于数学运算，其可以连接运算符前后的两个数值或表达式，对数值或表达式进行加
（+）、减（-）、乘（*）、除（/）和取模（%）运算。

![Untitled](Programming/Programming%20d6786caa2ba94b7983a41b4ab876f28f/MySQL/运算符%20e5d48a66f7b34702813529225fae8b0a/Untitled.png)

```sql
mysql> SELECT 100, 100 + 0, 100 - 0, 100 + 50, 100 + 50 -30, 100 + 35.5, 100 - 35.5
FROM dual;#伪表
+-----+---------+---------+----------+--------------+------------+------------+
| 100 | 100 + 0 | 100 - 0 | 100 + 50 | 100 + 50 -30 | 100 + 35.5 | 100 - 35.5 |
+-----+---------+---------+----------+--------------+------------+------------+
| 100 |     100 |     100 |      150 |          120 |      135.5 |       64.5 |
+-----+---------+---------+----------+--------------+------------+------------+
1 row in set (0.00 sec)

#SQL中，没有拼接运算符，+只能表示加法，当加上字符串的时候会对字符串进行隐式转换！
mysql> select 100+'1' from dual;
+---------+
| 100+'1' |
+---------+
|     101 |
+---------+
1 row in set (0.00 sec)

mysql> select 100+'hello' from dual;#转换失败了，按照0计算
+-------------+
| 100+'hello' |
+-------------+
|         100 |
+-------------+
1 row in set, 1 warning (0.00 sec) #有警告

mysql> select concat(first_name,' ',last_name) names from employees;#字符串的拼接用concat()
+-------------------+
| names             |
+-------------------+
| Steven King       |
| Neena Kochhar     |
| Lex De Haan       |
| William Gietz     |
+-------------------+
4 rows in set (0.00 sec)
```

<aside>
💡 在Java中， `+` 的左右两边如果有字符串，那么表示字符串的拼接。但是在MySQL中 `+` 只表示数值相加。如果遇到非数值类型，先尝试转成数值，**如果转失败，就按0计算**。（补充：MySQL中字符串拼接要使用字符串函数CONCAT()实现）

</aside>

### 乘除运算符

```sql
mysql> SELECT 100, 100 * 1, 100 * 1.0, 100 / 1.0, 100 / 2,100 + 2 * 5 / 2,100 /3, 100
    -> DIV 0 FROM dual;
+-----+---------+-----------+-----------+---------+-----------------+---------+-----------+
| 100 | 100 * 1 | 100 * 1.0 | 100 / 1.0 | 100 / 2 | 100 + 2 * 5 / 2 | 100 /3  | 100 DIV 0 |
+-----+---------+-----------+-----------+---------+-----------------+---------+-----------+
| 100 |     100 |     100.0 |  100.0000 | 50.0000 |        105.0000 | 33.3333 |      NULL |
+-----+---------+-----------+-----------+---------+-----------------+---------+-----------+
1 row in set (0.00 sec)
```

<aside>
💡 一个数乘以整数1和除以整数1后仍得原数；
一个数乘以浮点数1和除以浮点数1后变成浮点数，数值与原数相等；
一个数除以整数后，**不管是否能除尽，结果都为一个浮点数**；
一个数除以另一个数，除不尽时，结果为一个浮点数，并保留到**小数点后4位**；
乘法和除法的优先级相同，进行先乘后除操作与先除后乘操作，得出的结果相同。
在数学运算中，0不能用作除数，在MySQL中，**一个数除以0为NULL**。

</aside>

### 取余运算

```sql
mysql> select * from employees where employee_id MOD 2 =0;#筛选出employee_id是偶数的员工
```

## 比较运算符

比较运算符用来对表达式左边的操作数和右边的操作数进行比较，比较的结果为**真则返回1**，比较的结果为**假则返回0**，其他情况则返回NULL。
比较运算符经常被用来作为SELECT查询语句的条件来使用，返回符合条件的结果记录。

### 符号运算符

![Untitled](Programming/Programming%20d6786caa2ba94b7983a41b4ab876f28f/MySQL/运算符%20e5d48a66f7b34702813529225fae8b0a/Untitled%201.png)

1. **等号运算符** `=` 
    
    判断等号两边的值、字符串或表达式是否相等，如果相等则返回1，不相等则返回0。
    在使用等号运算符时，遵循如下规则：
    
    1. 如果等号两边的值、字符串或表达式都为字符串，则MySQL会**按照字符串进行比较**，其比较的是每个字符串中字符的ANSI编码是否相等。
    2. 如果等号两边的值都是整数，则MySQL会按照整数来比较两个值的大小。
    3. 如果等号两边的值一个是整数，另一个是字符串，则MySQL会将**字符串转化为数字**进行比较。
    4. 如果等号两边的值、字符串或表达式中**有一个为NULL，则比较结果为NULL**。
    
    对比：SQL中赋值符号使用 `:=`
    
    只要有 `null` 参与的运算结果都是 `null` ，包括 `select null=null;` 也是 `null` 。
    
    ```sql
    SELECT employee_id,salary FROM employees WHERE salary = 10000;#筛选出薪水=10000的人
    #最终的结果是没有结果，NULL和任何值比较都是NULL
    SELECT employee_id,salary FROM employees WHERE salary = NULL;
    ```
    
2. **安全等于** `<=>` 
    
    安全等于运算符 `<=>` 与等于运算符 `=` 的作用是相似的， 唯一的区别 是 `<=>` 可以用来对`NULL` 进行判断。在两个操作数均为 `NULL` 时，其返回值为1，而不为`NULL`；当一个操作数为`NULL`时，其返回值为0，而不为`NULL`。
    
    ```sql
    mysql> select null<=>null,null<=>1,null<=>0 from dual;
    +-------------+----------+----------+
    | null<=>null | null<=>1 | null<=>0 |
    +-------------+----------+----------+
    |           1 |        0 |        0 |
    +-------------+----------+----------+
    1 row in set (0.00 sec)
    
    #用<=>就可以输出有关null的条目
    mysql> select last_name,commission_pct from employees where commission_pct**<=>**null;
    +-------------+----------------+
    | last_name   | commission_pct |
    +-------------+----------------+
    | King        |           NULL |
    | Kochhar     |           NULL |
    | Higgins     |           NULL |
    | Gietz       |           NULL |
    +-------------+----------------+
    4 rows in set (0.00 sec)
    ```
    

### 关键字运算符

![Untitled](Programming/Programming%20d6786caa2ba94b7983a41b4ab876f28f/MySQL/运算符%20e5d48a66f7b34702813529225fae8b0a/Untitled%202.png)

1. **关于 `null` 的关键词** 
    
    有 `IS NULL` `IS NOT NULL` 还有 `ISNULL`
    
    ```sql
    mysql> select last_name,commission_pct from employees where commission_pct**<=>**null;
    +-------------+----------------+
    | last_name   | commission_pct |
    +-------------+----------------+
    | King        |           NULL |
    | Kochhar     |           NULL |
    | Higgins     |           NULL |
    | Gietz       |           NULL |
    +-------------+----------------+
    4 rows in set (0.00 sec)
    #is null就相当于 <=>null
    mysql> select last_name,commission_pct from employees where commission_pct IS NULL;
    +-------------+----------------+
    | last_name   | commission_pct |
    +-------------+----------------+
    | King        |           NULL |
    | Kochhar     |           NULL |
    | Higgins     |           NULL |
    | Gietz       |           NULL |
    +-------------+----------------+
    4 rows in set (0.00 sec)
    
    #is null的函数形式
    mysql> select last_name,commission_pct from employees where ISNULL(commission_pct);
    +-------------+----------------+
    | last_name   | commission_pct |
    +-------------+----------------+
    | King        |           NULL |
    | Kochhar     |           NULL |
    | Higgins     |           NULL |
    | Gietz       |           NULL |
    +-------------+----------------+
    4 rows in set (0.00 sec)
    ----------------------------------------------------------------
    #is not null
    mysql> select last_name,commission_pct from employees where commission_pct IS NOT NULL;
    +------------+----------------+
    | last_name  | commission_pct |
    +------------+----------------+
    | Russell    |           0.40 |
    | Grant      |           0.15 |
    | Johnson    |           0.10 |
    +------------+----------------+
    3 rows in set (0.00 sec)
    
    #NOT 要加在整个判断表达式的前面
    mysql> select last_name,commission_pct from employees where **NOT** commission_pct**<=>**null;
    +------------+----------------+
    | last_name  | commission_pct |
    +------------+----------------+
    | Russell    |           0.40 |
    | Grant      |           0.15 |
    | Johnson    |           0.10 |
    +------------+----------------+
    3 rows in set (0.00 sec)
    
    ```
    
2. **最值的比较**
    
    `least` & `greatest` 
    
    ```sql
    mysql> select greatest('a','b','c'),least(1,2,3) from dual;
    +-----------------------+--------------+
    | greatest('a','b','c') | least(1,2,3) |
    +-----------------------+--------------+
    | c                     |            1 |
    +-----------------------+--------------+
    1 row in set (0.00 sec)
    
    mysql> select least(length('abcde'),length('aaa')) from dual;
    +--------------------------------------+
    | least(length('abcde'),length('aaa')) |
    +--------------------------------------+
    |                                    3 |
    +--------------------------------------+
    1 row in set (0.00 sec)
    ```
    
3. **连续区间**
    
    `between ... and ...` 这里取得是闭区间，相当于 `x>= ... && x<= ...`
    
    **注意：** 前面的数一定要小于后面的数，前面的是下限，后面的是上限。如果反了的话就没有结果。 
    
    ```sql
    mysql> select employee_id,first_name,salary from employees where salary between 7500 and 7800;
    +-------------+-------------+---------+
    | employee_id | first_name  | salary  |
    +-------------+-------------+---------+
    |         111 | Ismael      | 7700.00 |
    |         112 | Jose Manuel | 7800.00 |
    |         154 | Nanette     | 7500.00 |
    |         160 | Louise      | 7500.00 |
    +-------------+-------------+---------+
    4 rows in set (0.00 sec)
    
    mysql> select employee_id,first_name,salary from employees where salary>=7500 && salary<=7800;
    +-------------+-------------+---------+
    | employee_id | first_name  | salary  |
    +-------------+-------------+---------+
    |         111 | Ismael      | 7700.00 |
    |         112 | Jose Manuel | 7800.00 |
    |         154 | Nanette     | 7500.00 |
    |         160 | Louise      | 7500.00 |
    +-------------+-------------+---------+
    4 rows in set, 1 warning (0.00 sec)
    
    #此处上下界写反
    mysql> select employee_id,first_name,salary from employees where salary between 7800 and 7300;
    Empty set (0.00 sec)
    
    #前面加not可以直接取反
    mysql> select employee_id,first_name,salary from employees where salary not between 2200 and 13000;
    +-------------+------------+----------+
    | employee_id | first_name | salary   |
    +-------------+------------+----------+
    |         100 | Steven     | 24000.00 |
    |         101 | Neena      | 17000.00 |
    |         102 | Lex        | 17000.00 |
    |         132 | TJ         |  2100.00 |
    |         145 | John       | 14000.00 |
    |         146 | Karen      | 13500.00 |
    +-------------+------------+----------+
    6 rows in set (0.00 sec)
    
    ```
    
4. **离散区间**
    
    `in (...,...)` & `not in (... , ...)` 相当于用 `or` 将所有的值连接起来。
    
    **注意：** 使用 `or` 的时候，要将条件写完整。
    
    ```sql
    mysql> select first_name,department_id from employees where department_id in (10,20);
    +------------+---------------+
    | first_name | department_id |
    +------------+---------------+
    | Jennifer   |            10 |
    | Michael    |            20 |
    | Pat        |            20 |
    +------------+---------------+
    3 rows in set (0.00 sec)mysql> select first_name,department_id from employees 
                               -> where department_id =10 or department_id=20;
    +------------+---------------+
    | first_name | department_id |
    +------------+---------------+
    | Jennifer   |            10 |
    | Michael    |            20 |
    | Pat        |            20 |
    +------------+---------------+
    3 rows in set (0.00 sec)
    ```
    
5. **模糊查询**
    
    `like ''` 比如说查询名字里包含 `'a'` 的人： `where first_name like '%a%'` 
    
    `%` 表示了**不定个数**的不确定字符。如果不加 `%` 的话， `like` 就和 `=` 效果是一样的。
    
    `_` 表示了 **一个** 不确定的字符，比如第二个是 `'a'` 的名字： `like '_a%'` ，如果需要查询带 `_`
    
    的名字，就要**使用转义字符**
    
    ```sql
    mysql> select first_name
        -> from employees
        -> where first_name like 'a';
    Empty set (0.00 sec)
    
    mysql> select first_name
        -> from employees
        -> where first_name like '%a';
    		-> #此处由于只匹配在a前有n个字符的名字，于是只输出末尾是a的名字
    +------------+
    | first_name |
    +------------+
    | Neena      |
    | Diana      |
    | Alana      |
    +------------+
    3 rows in set (0.00 sec)
    
    mysql> select first_name
        -> from employees
        -> where first_name like '%a%';#此处匹配的就是内含a的名字
    +-------------+
    | first_name  |
    +-------------+
    | Alexander   |
    | David       |
    | Pat         |
    | Hermann     |
    +-------------+
    4 rows in set (0.00 sec)
    
    #选出第三个是a的名字
    mysql> select first_name from employees where first_name like '__a%';
    +------------+
    | first_name |
    +------------+
    | Diana      |
    | Jean       |
    | Alana      |
    +------------+
    3 rows in set (0.00 sec)
    
    mysql> insert into employees values(1,'h_hh','h_hh','11','11',20191013,'AD_VP',2222.2,0.11,1,90);
    Query OK, 1 row affected (0.01 sec)
    
    mysql> select first_name from employees where first_name like '_\_%';
    +------------+
    | first_name |
    +------------+
    | h_hh       |
    +------------+
    1 row in set (0.00 sec)
    
    mysql> select first_name from employees where first_name like '_$_%';
    Empty set (0.00 sec)
    #用 escape 关键字修改转义符为's'
    mysql> select first_name from employees where first_name like '_$_%' escape '$';
    +------------+
    | first_name |
    +------------+
    | h_hh       |
    +------------+
    1 row in set (0.00 sec)
    ```
    
6. **正则表达式**
    
    `regexp` & `rlike` 
    
    语法格式为： `expr REGEXP 匹配条件` 。如果`expr`满足匹配条件，返回1，如果不满足，则返回0。若expr或匹配**条件任意一个为NULL，则结果为NULL**。
    
    REGEXP运算符在进行匹配时，常用的有下面几种通配符：
    
    1. `^`匹配以该字符后面的字符开头的字符串。
    2. `$`匹配以该字符前面的字符结尾的字符串。
    3. `.`匹配任何一个单字符。
    4. `“[...]”`匹配在方括号内的任何字符。例如，`“[abc]”`匹配`“a”`或`“b”`或`“c”`。为了命名字符的范围，使用一个`-`。`“[a-z]”`匹配任何字母，而`“[0-9]”`匹配任何数字。
    5. `*`*匹配零个或多个在它前面的字符。例如， `x*`* 匹配任何数量的 `x` 字符， `"[0-9]*"` *匹配任何数量的数字，而 `"*"`* 匹配任何数量的任何字符。
    
    ```sql
    mysql> select 'abcde' rlike 'ab';#连起来的ab
    +--------------------+
    | 'abcde' rlike 'ab' |
    +--------------------+
    |                  1 |
    +--------------------+
    1 row in set (0.01 sec)
    
    mysql> select 'abcde' rlike 'ac';
    +--------------------+
    | 'abcde' rlike 'ac' |
    +--------------------+
    |                  0 |
    +--------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike 'a.c';
    +---------------------+
    | 'abcde' rlike 'a.c' |
    +---------------------+
    |                   1 |
    +---------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike '[acg]';
    +-----------------------+
    | 'abcde' rlike '[acg]' |
    +-----------------------+
    |                     1 |
    +-----------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike '^a';
    +--------------------+
    | 'abcde' rlike '^a' |
    +--------------------+
    |                  1 |
    +--------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike '$a';
    +--------------------+
    | 'abcde' rlike '$a' |
    +--------------------+
    |                  0 |
    +--------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike '$e';#$放在前面
    +--------------------+
    | 'abcde' rlike '$e' |
    +--------------------+
    |                  0 |
    +--------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike 'e$';
    +--------------------+
    | 'abcde' rlike 'e$' |
    +--------------------+
    |                  1 |
    +--------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike '[e-g]';
    +-----------------------+
    | 'abcde' rlike '[e-g]' |
    +-----------------------+
    |                     1 |
    +-----------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike '[f-g]';
    +-----------------------+
    | 'abcde' rlike '[f-g]' |
    +-----------------------+
    |                     0 |
    +-----------------------+
    1 row in set (0.00 sec)
    
    mysql> select 'abcde' rlike 'a*';
    +--------------------+
    | 'abcde' rlike 'a*' |
    +--------------------+
    |                  1 |
    +--------------------+
    1 row in set (0.00 sec)
    
    ```
    
    [正则表达式.pdf](正则表达式.pdf)
    

### 逻辑运算符

逻辑运算符主要用来判断表达式的真假，在MySQL中，逻辑运算符的返回结果为1、0或者NULL。

![Untitled](Programming/Programming%20d6786caa2ba94b7983a41b4ab876f28f/MySQL/运算符%20e5d48a66f7b34702813529225fae8b0a/Untitled%203.png)

1. **非**
    
    `NOT` & `!` 
    
    ```sql
    mysql> SELECT NOT 1, NOT 0, NOT(1+1), NOT !1, NOT NULL;
    +-------+-------+----------+--------+----------+
    | NOT 1 | NOT 0 | NOT(1+1) | NOT !1 | NOT NULL |
    +-------+-------+----------+--------+----------+
    |     0 |     1 |        0 |      1 |     NULL |
    +-------+-------+----------+--------+----------+
    1 row in set, 1 warning (0.00 sec)
    ```
    
2. **与**
    
    `AND` & `&&` **注意：** 不管有无 `NULL` ，只要有 `0` 就返回 `0` 
    
    ```sql
    mysql>  SELECT 1 AND -1, 0 AND 1, 0 AND NULL, 1 AND NULL;
    +----------+---------+------------+------------+
    | 1 AND -1 | 0 AND 1 | 0 AND NULL | 1 AND NULL |
    +----------+---------+------------+------------+
    |        1 |       0 |          0 |       NULL |
    +----------+---------+------------+------------+
    1 row in set (0.00 sec)
    ```
    
3. **或**
    
    `OR` & `||` **注意：** 不管有无 `NULL` ，只要有 `1` 就返回 `1`
    
    ```sql
    mysql> SELECT 1 OR -1, 1 OR 0, 1 OR NULL, 0 || NULL, NULL || NULL;
    +---------+--------+-----------+-----------+--------------+
    | 1 OR -1 | 1 OR 0 | 1 OR NULL | 0 || NULL | NULL || NULL |
    +---------+--------+-----------+-----------+--------------+
    |       1 |      1 |         1 |      NULL |         NULL |
    +---------+--------+-----------+-----------+--------------+
    1 row in set, 2 warnings (0.00 sec)
    ```
    
    <aside>
    💡 **注意：**
    `OR`可以和`AND`一起使用，但是在使用时要注意两者的优先级，由于`AND`的优先级**高于**`OR`，因此先对`AND`两边的操作数进行操作，再与`OR`中的操作数结合。
    
    </aside>
    
4. **异或**
    
    `XOR` **注意：** 逻辑异或 `XOR` 运算符是当给定的值中 **任意** 一个值为 `NULL` 时，则返回 `NULL`；
    
    如果两个 **非** `NULL` 的值都是 `0` 或者都不等于 `0` 时，则返回 `0` ；如果一个值为 `0` ，另一个值不为 `0` 时，则返回 `1` 。 **(异为真）**
    
    ```sql
    mysql> SELECT 1 XOR -1, 1 XOR 0, 0 XOR 0, 1 XOR NULL, 1 XOR 1 XOR 1, 0 XOR 0 XOR 0;
    +----------+---------+---------+------------+---------------+---------------+
    | 1 XOR -1 | 1 XOR 0 | 0 XOR 0 | 1 XOR NULL | 1 XOR 1 XOR 1 | 0 XOR 0 XOR 0 |
    +----------+---------+---------+------------+---------------+---------------+
    |        0 |       1 |       0 |       NULL |             1 |             0 |
    +----------+---------+---------+------------+---------------+---------------+
    1 row in set (0.00 sec)
    ```
    

### 位运算符

位运算符是在二进制数上进行计算的运算符。位运算符会先将操作数变成二进制数，然后进行位运算，最后将计算结果从二进制变回十进制数。

![Untitled](Programming/Programming%20d6786caa2ba94b7983a41b4ab876f28f/MySQL/运算符%20e5d48a66f7b34702813529225fae8b0a/Untitled%204.png)

### 优先级（越往下越高）

![Untitled](Programming/Programming%20d6786caa2ba94b7983a41b4ab876f28f/MySQL/运算符%20e5d48a66f7b34702813529225fae8b0a/Untitled%205.png)